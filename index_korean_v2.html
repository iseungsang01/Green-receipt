<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GreenReceipt v2 â€” ì„œìš¸ íƒ„ì†Œ ë°ì´í„° í”Œë«í¼</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@300;400;500&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #060a06;
  --bg2: #0d130d;
  --bg3: #131c13;
  --green: #39ff88;
  --green2: #00cc55;
  --green-dim: rgba(57,255,136,0.08);
  --green-glow: rgba(57,255,136,0.2);
  --amber: #ffcc00;
  --red: #ff4444;
  --blue: #44aaff;
  --text: #e0f0e0;
  --muted: #5a805a;
  --border: rgba(57,255,136,0.1);
  --border2: rgba(57,255,136,0.22);
  --card: rgba(13,19,13,0.95);
  --r: 14px;
  --r-sm: 8px;
}
*{box-sizing:border-box;margin:0;padding:0}
html{scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:'Noto Sans KR',sans-serif;min-height:100vh;overflow-x:hidden}

/* GRID BACKGROUND */
body::before{
  content:'';position:fixed;inset:0;
  background-image:
    linear-gradient(rgba(57,255,136,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(57,255,136,0.03) 1px, transparent 1px);
  background-size:40px 40px;
  pointer-events:none;z-index:0;
}
body::after{
  content:'';position:fixed;inset:0;
  background:
    radial-gradient(ellipse 50% 40% at 75% 15%, rgba(57,255,136,0.06) 0%, transparent 70%),
    radial-gradient(ellipse 40% 50% at 15% 75%, rgba(0,204,85,0.04) 0%, transparent 70%);
  pointer-events:none;z-index:0;
}

/* NAV */
nav{
  position:sticky;top:0;z-index:100;
  display:flex;align-items:center;justify-content:space-between;
  padding:14px 28px;
  background:rgba(6,10,6,0.9);
  backdrop-filter:blur(20px);
  border-bottom:1px solid var(--border);
}
.logo{
  font-family:'Bebas Neue',sans-serif;
  font-size:1.5rem;letter-spacing:0.08em;
  color:var(--green);
  display:flex;align-items:center;gap:10px;
}
.logo-dot{
  width:8px;height:8px;background:var(--green);
  border-radius:50%;animation:blink 2s infinite;
}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0.2}}

.nav-pills{
  display:flex;gap:2px;
  background:var(--bg3);border:1px solid var(--border);
  border-radius:50px;padding:3px;
}
.pill{
  padding:7px 16px;border-radius:50px;
  font-size:0.75rem;font-weight:500;letter-spacing:0.04em;
  color:var(--muted);cursor:pointer;transition:all 0.2s;
  white-space:nowrap;
}
.pill:hover{color:var(--text)}
.pill.active{background:var(--green);color:#060a06;font-weight:700}

.nav-meta{display:flex;align-items:center;gap:10px}
.esg-badge{
  font-family:'DM Mono',monospace;font-size:0.75rem;
  padding:5px 12px;border-radius:50px;
  border:1px solid var(--border2);
  background:var(--green-dim);color:var(--green);
  cursor:pointer;
}

/* PAGES */
.page{display:none;position:relative;z-index:1;max-width:1280px;margin:0 auto;padding:36px 28px 60px}
.page.active{display:block}

/* PAGE HEADER */
.ph{margin-bottom:32px}
.ph-tag{font-family:'DM Mono',monospace;font-size:0.68rem;letter-spacing:0.15em;color:var(--green);text-transform:uppercase;margin-bottom:6px}
.ph-title{font-family:'Bebas Neue',sans-serif;font-size:2.6rem;letter-spacing:0.04em;color:var(--text);line-height:1}
.ph-sub{font-size:0.82rem;color:var(--muted);margin-top:8px;line-height:1.6}

/* CARDS */
.card{background:var(--card);border:1px solid var(--border);border-radius:var(--r);padding:24px;position:relative;overflow:hidden;transition:border-color 0.3s}
.card:hover{border-color:var(--border2)}
.card-title{font-family:'DM Mono',monospace;font-size:0.68rem;letter-spacing:0.12em;text-transform:uppercase;color:var(--muted);margin-bottom:16px}
.card-accent{position:absolute;top:0;left:0;right:0;height:2px;background:var(--green);opacity:0.5}
.card-accent.amber{background:var(--amber)}
.card-accent.blue{background:var(--blue)}
.card-accent.red{background:var(--red)}

/* STAT */
.stat-val{font-family:'Bebas Neue',sans-serif;font-size:3rem;line-height:1;color:var(--green)}
.stat-val.amber{color:var(--amber)}
.stat-val.red{color:var(--red)}
.stat-val.blue{color:var(--blue)}
.stat-unit{font-size:0.8rem;color:var(--muted);margin-top:4px}
.stat-delta{display:inline-flex;align-items:center;gap:4px;font-size:0.72rem;padding:2px 8px;border-radius:50px;margin-top:8px;font-family:'DM Mono',monospace}
.delta-good{background:rgba(57,255,136,0.1);color:var(--green)}
.delta-warn{background:rgba(255,204,0,0.1);color:var(--amber)}
.delta-bad{background:rgba(255,68,68,0.1);color:var(--red)}

/* GRID LAYOUTS */
.g2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.g3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
.g4{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}
.gap{margin-bottom:16px}
.gap-lg{margin-bottom:28px}

/* BADGE */
.badge{display:inline-flex;align-items:center;gap:5px;padding:4px 12px;border-radius:50px;font-size:0.72rem;font-family:'DM Mono',monospace;border:1px solid var(--border2);background:var(--green-dim);color:var(--green)}

/* BTN */
.btn{padding:10px 22px;border-radius:50px;font-size:0.8rem;font-weight:600;cursor:pointer;transition:all 0.2s;letter-spacing:0.04em;font-family:'Noto Sans KR',sans-serif;border:none}
.btn-g{background:var(--green);color:#060a06}
.btn-g:hover{background:#55ffaa;transform:translateY(-1px);box-shadow:0 4px 20px rgba(57,255,136,0.3)}
.btn-o{background:transparent;color:var(--green);border:1px solid var(--border2)}
.btn-o:hover{background:var(--green-dim)}

/* PROGRESS BAR */
.pbar-bg{height:6px;background:rgba(255,255,255,0.05);border-radius:3px;overflow:hidden;margin-top:6px}
.pbar-fill{height:100%;border-radius:3px;transition:width 1.2s cubic-bezier(0.4,0,0.2,1)}

/* TOAST */
.toast{
  position:fixed;bottom:28px;left:50%;transform:translateX(-50%) translateY(80px);
  background:var(--bg3);border:1px solid var(--border2);
  color:var(--text);padding:12px 24px;border-radius:50px;
  font-size:0.8rem;z-index:999;opacity:0;
  transition:all 0.4s cubic-bezier(0.4,0,0.2,1);
  white-space:nowrap;
}
.toast.show{transform:translateX(-50%) translateY(0);opacity:1}

/* ===================================================
   PAGE 1: ëŒ€ì‹œë³´ë“œ (ê¸°ì¡´ + í–‰ë™ê²½ì œí•™ UX)
   =================================================== */
.streak-bar{display:flex;gap:6px;margin-top:4px}
.streak-day{
  width:28px;height:28px;border-radius:6px;
  display:flex;align-items:center;justify-content:center;
  font-size:0.6rem;font-family:'DM Mono',monospace;
  border:1px solid var(--border);color:var(--muted);
}
.streak-day.done{background:var(--green);border-color:var(--green);color:#060a06;font-weight:700}
.streak-day.today{border-color:var(--green);color:var(--green);animation:pulse-border 1.5s infinite}
@keyframes pulse-border{0%,100%{box-shadow:0 0 0 0 rgba(57,255,136,0.4)}50%{box-shadow:0 0 0 4px rgba(57,255,136,0)}}

/* ì†ì‹¤ íšŒí”¼ ì•Œë¦¼ */
.loss-alert{
  border:1px solid rgba(255,204,0,0.3);background:rgba(255,204,0,0.05);
  border-radius:var(--r);padding:16px 20px;
  display:flex;align-items:center;gap:14px;
  animation:alertPulse 3s infinite;
}
@keyframes alertPulse{0%,100%{border-color:rgba(255,204,0,0.3)}50%{border-color:rgba(255,204,0,0.7)}}
.loss-icon{font-size:1.6rem;flex-shrink:0}
.loss-text{font-size:0.82rem;line-height:1.6}
.loss-number{font-family:'Bebas Neue',sans-serif;font-size:1.4rem;color:var(--amber);line-height:1}

/* ì˜ˆì¸¡ ê²Œì´ì§€ */
.predict-bar{
  height:20px;background:rgba(255,255,255,0.05);
  border-radius:10px;overflow:hidden;position:relative;margin:10px 0;
}
.predict-fill{
  height:100%;border-radius:10px;
  background:linear-gradient(90deg,var(--green),var(--amber));
  transition:width 1.5s cubic-bezier(0.4,0,0.2,1);
  position:relative;
}
.predict-marker{
  position:absolute;top:-4px;height:28px;width:2px;
  background:var(--red);opacity:0.8;
}
.predict-label{
  position:absolute;right:0;top:0;bottom:0;
  display:flex;align-items:center;padding-right:10px;
  font-family:'DM Mono',monospace;font-size:0.7rem;color:#060a06;font-weight:700;
}

/* ===================================================
   PAGE 2: ì„œìš¸ íƒ„ì†Œ ì§€ë„
   =================================================== */
.map-layout{display:grid;grid-template-columns:1fr 320px;gap:20px;align-items:start}

#seoulMap svg{width:100%;height:auto;cursor:pointer}
.gu-path{
  stroke:#1a2a1a;stroke-width:1.5;
  transition:all 0.3s;cursor:pointer;
}
.gu-path:hover{stroke:var(--green);stroke-width:2.5;filter:brightness(1.3)}
.gu-path.selected{stroke:var(--green);stroke-width:3;filter:brightness(1.5)}

.map-legend{display:flex;align-items:center;gap:8px;margin-bottom:16px;flex-wrap:wrap}
.legend-bar{
  display:flex;height:10px;border-radius:5px;overflow:hidden;flex:1;min-width:120px;
}
.legend-seg{flex:1}
.legend-labels{display:flex;justify-content:space-between;font-size:0.65rem;font-family:'DM Mono',monospace;color:var(--muted);margin-top:4px}

.gu-panel{
  background:var(--card);border:1px solid var(--border);
  border-radius:var(--r);padding:20px;
  min-height:200px;
}
.gu-name{font-family:'Bebas Neue',sans-serif;font-size:1.8rem;color:var(--green);letter-spacing:0.05em}
.gu-co2{font-family:'Bebas Neue',sans-serif;font-size:3rem;line-height:1}
.gu-rank{font-size:0.75rem;font-family:'DM Mono',monospace;color:var(--muted);margin-top:4px}
.gu-cats{display:flex;flex-direction:column;gap:8px;margin-top:16px}
.gu-cat-row{display:flex;align-items:center;gap:8px;font-size:0.78rem}
.gu-cat-name{width:60px;color:var(--muted);flex-shrink:0}
.gu-cat-bar{flex:1;height:5px;background:rgba(255,255,255,0.05);border-radius:3px;overflow:hidden}
.gu-cat-fill{height:100%;border-radius:3px}

.trend-note{
  padding:10px 14px;background:var(--bg3);border:1px solid var(--border);
  border-radius:var(--r-sm);font-size:0.75rem;color:var(--muted);
  line-height:1.6;margin-top:12px;
}
.trend-note b{color:var(--green)}

.district-list{
  display:grid;grid-template-columns:1fr 1fr;gap:6px;
  max-height:200px;overflow-y:auto;margin-top:8px;
}
.district-item{
  display:flex;align-items:center;justify-content:space-between;
  padding:6px 10px;background:var(--bg3);border:1px solid var(--border);
  border-radius:var(--r-sm);font-size:0.72rem;cursor:pointer;
  transition:border-color 0.2s;
}
.district-item:hover{border-color:var(--green)}
.district-item.selected{border-color:var(--green);background:var(--green-dim)}

/* ===================================================
   PAGE 3: ESG ìŠ¤ì½”ì–´
   =================================================== */
.esg-hero{
  display:grid;grid-template-columns:260px 1fr;gap:24px;
  align-items:center;margin-bottom:24px;
}
.esg-ring-wrap{position:relative;width:220px;height:220px}
.esg-ring-svg{width:220px;height:220px;transform:rotate(-90deg)}
.esg-ring-bg{fill:none;stroke:rgba(57,255,136,0.08);stroke-width:16}
.esg-ring-e{fill:none;stroke:#39ff88;stroke-width:16;stroke-linecap:round;stroke-dasharray:565;stroke-dashoffset:565;transition:stroke-dashoffset 1.8s cubic-bezier(0.4,0,0.2,1);filter:drop-shadow(0 0 8px rgba(57,255,136,0.5))}
.esg-ring-s{fill:none;stroke:#44aaff;stroke-width:8;stroke-linecap:round;stroke-dasharray:565;stroke-dashoffset:565;opacity:0.6;transition:stroke-dashoffset 1.8s 0.3s cubic-bezier(0.4,0,0.2,1)}
.esg-ring-g{fill:none;stroke:#ffcc00;stroke-width:4;stroke-linecap:round;stroke-dasharray:565;stroke-dashoffset:565;opacity:0.4;transition:stroke-dashoffset 1.8s 0.6s cubic-bezier(0.4,0,0.2,1)}
.esg-center{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center}
.esg-total{font-family:'Bebas Neue',sans-serif;font-size:3.2rem;color:var(--green);line-height:1}
.esg-label{font-family:'DM Mono',monospace;font-size:0.65rem;color:var(--muted)}

.esg-breakdown{display:flex;flex-direction:column;gap:12px}
.esg-metric{background:var(--bg3);border:1px solid var(--border);border-radius:var(--r-sm);padding:16px}
.esg-metric-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.esg-metric-name{font-size:0.82rem;font-weight:500}
.esg-metric-score{font-family:'Bebas Neue',sans-serif;font-size:1.6rem;line-height:1}
.esg-metric-desc{font-size:0.72rem;color:var(--muted);line-height:1.5}

/* ìœ í˜• ì¹´ë“œ */
.type-card{
  background:linear-gradient(135deg, var(--bg3), var(--bg2));
  border:1px solid var(--border2);border-radius:var(--r);
  padding:24px;text-align:center;
}
.type-emoji{font-size:3rem;margin-bottom:12px}
.type-name{font-family:'Bebas Neue',sans-serif;font-size:1.8rem;color:var(--green);letter-spacing:0.05em}
.type-desc{font-size:0.78rem;color:var(--muted);line-height:1.6;margin-top:8px}

.cluster-map{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:8px}
.cluster-dot{
  aspect-ratio:1;border-radius:var(--r-sm);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  padding:12px;font-size:0.65rem;text-align:center;border:1px solid var(--border);
  cursor:pointer;transition:all 0.2s;
}
.cluster-dot:hover{border-color:var(--green);transform:scale(1.03)}
.cluster-dot.me{border-color:var(--green);background:var(--green-dim);box-shadow:0 0 16px rgba(57,255,136,0.15)}
.cluster-emoji{font-size:1.4rem;margin-bottom:4px}

/* ===================================================
   PAGE 4: í–‰ë™ ì˜ˆì¸¡
   =================================================== */
.pred-layout{display:grid;grid-template-columns:1fr 340px;gap:20px}

.scenario-list{display:flex;flex-direction:column;gap:10px}
.scenario-item{
  background:var(--bg3);border:1px solid var(--border);
  border-radius:var(--r-sm);padding:14px 16px;
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  cursor:pointer;transition:all 0.2s;
}
.scenario-item:hover{border-color:var(--border2)}
.scenario-item.active{border-color:var(--green);background:var(--green-dim)}
.sc-info{flex:1}
.sc-name{font-size:0.82rem;font-weight:500}
.sc-desc{font-size:0.72rem;color:var(--muted);margin-top:2px}
.sc-impact{font-family:'DM Mono',monospace;font-size:0.8rem;padding:4px 10px;border-radius:50px}

.timeline-chart{position:relative;height:180px;margin:16px 0}
.tl-line{
  position:absolute;bottom:30px;left:0;right:0;
  border-top:1px dashed rgba(57,255,136,0.2);
}
.tl-goal{
  position:absolute;left:0;right:0;
  border-top:1px solid rgba(255,68,68,0.5);
  display:flex;align-items:center;justify-content:flex-end;
  padding-right:4px;
}
.tl-goal-label{font-size:0.62rem;font-family:'DM Mono',monospace;color:var(--red);transform:translateY(-50%)}
svg.tl-svg{width:100%;height:100%}
.tl-path-actual{fill:none;stroke:var(--green);stroke-width:2.5;stroke-linecap:round}
.tl-path-pred{fill:none;stroke:var(--amber);stroke-width:2;stroke-dasharray:5,3;stroke-linecap:round}
.tl-path-scenario{fill:none;stroke:var(--blue);stroke-width:2;stroke-dasharray:3,3;opacity:0.8}
.tl-area{fill:url(#greenGrad);opacity:0.15}

.insight-box{
  background:var(--bg3);border-left:3px solid var(--green);
  padding:14px 16px;border-radius:0 var(--r-sm) var(--r-sm) 0;
  font-size:0.8rem;line-height:1.6;
  margin-bottom:10px;
}
.insight-box b{color:var(--green)}
.insight-box.warn{border-left-color:var(--amber)}
.insight-box.warn b{color:var(--amber)}

.prob-display{
  text-align:center;padding:20px;
  background:var(--bg3);border:1px solid var(--border);border-radius:var(--r);
}
.prob-num{font-family:'Bebas Neue',sans-serif;font-size:4rem;color:var(--amber);line-height:1}
.prob-label{font-size:0.72rem;color:var(--muted);font-family:'DM Mono',monospace;margin-top:4px}

/* ===================================================
   PAGE 5: ì •ì±… ì‹œë®¬ë ˆì´ì…˜
   =================================================== */
.policy-layout{display:grid;grid-template-columns:1fr 380px;gap:20px}

.policy-list{display:flex;flex-direction:column;gap:10px;margin-bottom:20px}
.policy-item{
  background:var(--bg3);border:1px solid var(--border);
  border-radius:var(--r);padding:18px 20px;cursor:pointer;
  transition:all 0.3s;
}
.policy-item:hover,.policy-item.active{border-color:var(--green);background:var(--green-dim)}
.policy-header{display:flex;align-items:center;gap:12px;margin-bottom:8px}
.policy-icon{
  width:40px;height:40px;border-radius:10px;
  background:var(--green-dim);border:1px solid var(--border2);
  display:flex;align-items:center;justify-content:center;font-size:1.1rem;flex-shrink:0;
}
.policy-title{font-size:0.88rem;font-weight:700}
.policy-subtitle{font-size:0.72rem;color:var(--muted);margin-top:2px}

.slider-wrap{margin-top:12px}
.slider-label{display:flex;justify-content:space-between;font-size:0.72rem;color:var(--muted);font-family:'DM Mono',monospace;margin-bottom:6px}
input[type=range]{
  width:100%;-webkit-appearance:none;
  height:4px;border-radius:2px;outline:none;cursor:pointer;
  background:linear-gradient(90deg, var(--green) var(--val,30%), rgba(255,255,255,0.1) var(--val,30%));
}
input[type=range]::-webkit-slider-thumb{
  -webkit-appearance:none;width:16px;height:16px;border-radius:50%;
  background:var(--green);box-shadow:0 0 8px rgba(57,255,136,0.5);cursor:pointer;
}

.sim-result-card{
  background:var(--card);border:1px solid var(--border2);border-radius:var(--r);padding:24px;
  position:sticky;top:80px;
}
.sim-before-after{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin:16px 0}
.sim-side{text-align:center;padding:14px;border-radius:var(--r-sm);border:1px solid var(--border)}
.sim-side.before{background:rgba(255,68,68,0.05);border-color:rgba(255,68,68,0.2)}
.sim-side.after{background:rgba(57,255,136,0.05);border-color:rgba(57,255,136,0.2)}
.sim-side-val{font-family:'Bebas Neue',sans-serif;font-size:2rem;line-height:1}
.sim-side-label{font-size:0.65rem;font-family:'DM Mono',monospace;color:var(--muted);margin-top:4px}

.impact-bars{display:flex;flex-direction:column;gap:10px;margin:12px 0}
.impact-row{font-size:0.78rem}
.impact-name{display:flex;justify-content:space-between;margin-bottom:4px;color:var(--muted)}
.impact-name span:last-child{color:var(--text);font-family:'DM Mono',monospace}
</style>
</head>
<body>

<nav>
  <div class="logo"><div class="logo-dot"></div>GreenReceipt <span style="font-size:0.7rem;letter-spacing:0.15em;color:var(--muted);font-family:'DM Mono',monospace;margin-left:4px">v2.0</span></div>
  <div class="nav-pills">
    <div class="pill active" onclick="go('dash',this)">ëŒ€ì‹œë³´ë“œ</div>
    <div class="pill" onclick="go('map',this)">ğŸ—º ì„œìš¸ ì§€ë„</div>
    <div class="pill" onclick="go('esg',this)">ğŸ“Š ESG ìŠ¤ì½”ì–´</div>
    <div class="pill" onclick="go('pred',this)">ğŸ”® í–‰ë™ ì˜ˆì¸¡</div>
    <div class="pill" onclick="go('policy',this)">ğŸ› ì •ì±… ì‹¤í—˜ì‹¤</div>
  </div>
  <div class="nav-meta">
    <div class="esg-badge" onclick="go('esg',document.querySelectorAll('.pill')[2])">ESG B+ Â· 78ì </div>
  </div>
</nav>

<!-- ===================== DASHBOARD ===================== -->
<div class="page active" id="page-dash">
  <div class="ph">
    <div class="ph-tag">// Personal Carbon Dashboard Â· Feb 2026</div>
    <div class="ph-title">ë‚˜ì˜ íƒ„ì†Œ ê°€ê³„ë¶€</div>
    <div class="ph-sub">ì†Œë¹„ íŒ¨í„´ ê¸°ë°˜ ì‹¤ì‹œê°„ íƒ„ì†Œ ì¶”ì  Â· ì„œìš¸ì‹œ ìµëª… ë°ì´í„° ì§‘ê³„ ê¸°ì—¬</div>
  </div>

  <!-- ì†ì‹¤ íšŒí”¼ ì•Œë¦¼ -->
  <div class="loss-alert gap-lg" id="lossAlert">
    <div class="loss-icon">âš¡</div>
    <div style="flex:1">
      <div class="loss-number">17.3 kg COâ‚‚e</div>
      <div class="loss-text" style="color:var(--amber)">ëª©í‘œê¹Œì§€ <b style="color:var(--amber)">17.3kg</b> ë‚¨ì•˜ì–´ìš”.
        ì´ë²ˆ ì£¼ ì‚¼ê²¹ì‚´ 2ë²ˆ ë” ì‚¬ë©´ <b style="color:var(--red)">ëª©í‘œ ì´ˆê³¼ í™•ë¥  72%</b>ì…ë‹ˆë‹¤.</div>
    </div>
    <div style="font-size:0.7rem;color:var(--muted);cursor:pointer" onclick="this.parentElement.style.display='none'">âœ•</div>
  </div>

  <div class="g4 gap-lg">
    <div class="card">
      <div class="card-accent"></div>
      <div class="card-title">ì´ë²ˆ ë‹¬ ë°°ì¶œëŸ‰</div>
      <div class="stat-val">42.7</div>
      <div class="stat-unit">kg COâ‚‚e</div>
      <div class="stat-delta delta-good">â†“ 12% ì§€ë‚œë‹¬ ëŒ€ë¹„</div>
    </div>
    <div class="card">
      <div class="card-accent amber"></div>
      <div class="card-title">ëª©í‘œ ë‹¬ì„±ë¥ </div>
      <div class="stat-val amber">71%</div>
      <div class="stat-unit">ì›” ëª©í‘œ 60 kg</div>
      <div class="stat-delta delta-warn">âš¡ 17.3kg ë‚¨ìŒ</div>
    </div>
    <div class="card">
      <div class="card-accent blue"></div>
      <div class="card-title">ê·¸ë¦° í† í°</div>
      <div class="stat-val blue">340</div>
      <div class="stat-unit">GT Â· â‰ˆ 3,400ì›</div>
      <div class="stat-delta delta-good">+85 ì´ë²ˆ ë‹¬</div>
    </div>
    <div class="card">
      <div class="card-accent"></div>
      <div class="card-title">ìŠ¤ìº” ì—°ì†ì¼</div>
      <div class="stat-val">4<span style="font-size:1.5rem">ğŸ”¥</span></div>
      <div class="stat-unit">ì¼ ì—°ì†</div>
      <div class="stat-delta delta-good">7ì¼ê¹Œì§€ +30 GT</div>
    </div>
  </div>

  <!-- ìŠ¤íŠ¸ë¦­ + ì˜ˆì¸¡ -->
  <div class="g2 gap-lg">
    <div class="card">
      <div class="card-title">// 7ì¼ ì—°ì† ìŠ¤ìº” streak</div>
      <div class="streak-bar">
        <div class="streak-day done">ì›”</div>
        <div class="streak-day done">í™”</div>
        <div class="streak-day done">ìˆ˜</div>
        <div class="streak-day done">ëª©</div>
        <div class="streak-day today">ê¸ˆ</div>
        <div class="streak-day">í† </div>
        <div class="streak-day">ì¼</div>
      </div>
      <div style="margin-top:12px;font-size:0.75rem;color:var(--muted);line-height:1.6">
        ì˜¤ëŠ˜ ì˜ìˆ˜ì¦ì„ ìŠ¤ìº”í•˜ë©´ <span style="color:var(--green);font-weight:600">5ì¼ ì—°ì†</span>ì´ ë©ë‹ˆë‹¤.<br>
        7ì¼ ì™„ì£¼ ì‹œ <span style="color:var(--green)">+30 GT</span> + ë°°ì§€ íšë“!
      </div>
      <div style="margin-top:16px;display:flex;gap:8px">
        <button class="btn btn-g" style="flex:1;font-size:0.75rem">ğŸ“¸ ì˜¤ëŠ˜ ìŠ¤ìº”í•˜ê¸°</button>
      </div>
    </div>

    <div class="card">
      <div class="card-title">// AI ì›”ë§ ì˜ˆì¸¡</div>
      <div style="font-size:0.78rem;color:var(--muted);margin-bottom:10px">í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ ì›”ë§ ì˜ˆìƒ ë°°ì¶œëŸ‰</div>
      <div style="display:flex;align-items:baseline;gap:8px;margin-bottom:12px">
        <div style="font-family:'Bebas Neue',sans-serif;font-size:2.4rem;color:var(--amber)">58.2</div>
        <div style="font-size:0.8rem;color:var(--muted)">kg COâ‚‚e (ì˜ˆì¸¡)</div>
      </div>
      <div class="predict-bar">
        <div class="predict-fill" id="predFill" style="width:0%">
          <div class="predict-marker" style="left:calc(100% * 60/80)"></div>
          <div class="predict-label">58.2</div>
        </div>
      </div>
      <div style="display:flex;justify-content:space-between;font-size:0.62rem;font-family:'DM Mono',monospace;color:var(--muted);margin-top:4px">
        <span>0</span><span style="color:var(--red)">ëª©í‘œ 60kg</span><span>80kg</span>
      </div>
      <div style="margin-top:12px;font-size:0.75rem;color:var(--muted)">
        ì´ë²ˆ ì£¼ ìœ¡ë¥˜ êµ¬ë§¤ë¥¼ <span style="color:var(--green)">1íšŒ ì¤„ì´ë©´</span> ëª©í‘œ ë‹¬ì„± í™•ë¥  <span style="color:var(--green)">+23%p</span>
      </div>
    </div>
  </div>

  <!-- ì›”ë³„ ì°¨íŠ¸ -->
  <div class="card gap">
    <div class="card-title">// 6ê°œì›” ë°°ì¶œ ì¶”ì´ + ì˜ˆì¸¡ (kg COâ‚‚e)</div>
    <div style="display:flex;align-items:flex-end;gap:8px;height:140px" id="dashChart"></div>
    <div style="display:flex;gap:16px;margin-top:12px;font-size:0.7rem;font-family:'DM Mono',monospace">
      <div style="display:flex;align-items:center;gap:5px"><div style="width:12px;height:3px;background:var(--green);border-radius:2px"></div>ì‹¤ì œ</div>
      <div style="display:flex;align-items:center;gap:5px"><div style="width:12px;height:3px;background:var(--amber);border-radius:2px;opacity:0.7;border:1px dashed var(--amber)"></div>ì˜ˆì¸¡</div>
    </div>
  </div>
</div>

<!-- ===================== SEOUL MAP ===================== -->
<div class="page" id="page-map">
  <div class="ph">
    <div class="ph-tag">// Seoul Carbon Data Infrastructure Â· 2026</div>
    <div class="ph-title">ì„œìš¸ ì†Œë¹„ íƒ„ì†Œ ì§€ë„</div>
    <div class="ph-sub">GreenReceipt ì‚¬ìš©ì ìµëª… ë°ì´í„° ì§‘ê³„ Â· ìì¹˜êµ¬ ë‹¨ìœ„ íƒ„ì†Œ ë°°ì¶œ í˜„í™©</div>
  </div>

  <div class="g3 gap-lg" style="grid-template-columns:repeat(3,1fr)">
    <div class="card">
      <div class="card-title">ì´ ì§‘ê³„ ì˜ìˆ˜ì¦</div>
      <div class="stat-val">24,891</div>
      <div class="stat-unit">ê±´ Â· 2ì›” ê¸°ì¤€</div>
      <div class="stat-delta delta-good">â†‘ 31% ì „ì›” ëŒ€ë¹„</div>
    </div>
    <div class="card">
      <div class="card-accent amber"></div>
      <div class="card-title">ì„œìš¸ í‰ê·  íƒ„ì†Œ</div>
      <div class="stat-val amber">63.4</div>
      <div class="stat-unit">kg COâ‚‚e / ì›”</div>
      <div class="stat-delta delta-warn">â†“ 4.2% ì „ì›” ëŒ€ë¹„</div>
    </div>
    <div class="card">
      <div class="card-accent blue"></div>
      <div class="card-title">ì°¸ì—¬ ìì¹˜êµ¬</div>
      <div class="stat-val blue">25</div>
      <div class="stat-unit">/ 25ê°œ ìì¹˜êµ¬</div>
      <div class="stat-delta delta-good">ì „ ìì¹˜êµ¬ ì°¸ì—¬ ì™„ë£Œ ğŸ‰</div>
    </div>
  </div>

  <!-- ì¹´í…Œê³ ë¦¬ í•„í„° -->
  <div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap">
    <div class="badge" style="cursor:pointer" onclick="setMapMode('total',this)" id="filterTotal">ì „ì²´</div>
    <div style="display:flex;align-items:center;gap:4px;padding:4px 12px;border-radius:50px;font-size:0.72rem;font-family:'DM Mono',monospace;border:1px solid var(--border);color:var(--muted);cursor:pointer" onclick="setMapMode('food',this)">ğŸ¥© ì‹í’ˆ</div>
    <div style="display:flex;align-items:center;gap:4px;padding:4px 12px;border-radius:50px;font-size:0.72rem;font-family:'DM Mono',monospace;border:1px solid var(--border);color:var(--muted);cursor:pointer" onclick="setMapMode('living',this)">ğŸ§´ ìƒí™œìš©í’ˆ</div>
    <div style="display:flex;align-items:center;gap:4px;padding:4px 12px;border-radius:50px;font-size:0.72rem;font-family:'DM Mono',monospace;border:1px solid var(--border);color:var(--muted);cursor:pointer" onclick="setMapMode('clothing',this)">ğŸ‘• ì˜ë¥˜</div>
  </div>

  <div class="map-layout">
    <div>
      <div class="card" style="padding:16px">
        <div class="card-title">// ìì¹˜êµ¬ë³„ í‰ê·  íƒ„ì†Œ ë°°ì¶œëŸ‰ (kg COâ‚‚e/ì›”)</div>
        <div class="map-legend">
          <div style="font-size:0.65rem;font-family:'DM Mono',monospace;color:var(--muted)">ë‚®ìŒ</div>
          <div class="legend-bar">
            <div class="legend-seg" style="background:#0d3a1a"></div>
            <div class="legend-seg" style="background:#165c28"></div>
            <div class="legend-seg" style="background:#1e8038"></div>
            <div class="legend-seg" style="background:#39ff88;opacity:0.5"></div>
            <div class="legend-seg" style="background:#ffcc00;opacity:0.6"></div>
            <div class="legend-seg" style="background:#ff8800;opacity:0.7"></div>
            <div class="legend-seg" style="background:#ff4444;opacity:0.8"></div>
          </div>
          <div style="font-size:0.65rem;font-family:'DM Mono',monospace;color:var(--muted)">ë†’ìŒ</div>
        </div>
        <div id="seoulMap" style="background:var(--bg3);border-radius:var(--r-sm);padding:8px"></div>
      </div>

      <!-- ë­í‚¹ ë¦¬ìŠ¤íŠ¸ -->
      <div class="card" style="margin-top:16px">
        <div class="card-title">// ìì¹˜êµ¬ íƒ„ì†Œ ë°°ì¶œ ìˆœìœ„</div>
        <div class="district-list" id="districtRanking"></div>
      </div>
    </div>

    <div>
      <div class="gu-panel" id="guPanel">
        <div style="color:var(--muted);font-size:0.82rem;padding:20px 0">
          ì§€ë„ì—ì„œ ìì¹˜êµ¬ë¥¼ í´ë¦­í•˜ë©´<br>ìƒì„¸ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </div>
      </div>

      <div class="card" style="margin-top:16px">
        <div class="card-title">// ì›”ë³„ ì„œìš¸ íŠ¸ë Œë“œ</div>
        <div style="display:flex;align-items:flex-end;gap:5px;height:80px" id="cityChart"></div>
        <div class="trend-note" style="margin-top:10px">
          <b>ë§ˆí¬êµ¬</b> ì‹ë¬¼ì„± ì†Œë¹„ ë¹„ìœ¨ â†‘ 18%<br>
          <b>ê°•ë‚¨êµ¬</b> ìœ¡ë¥˜ íƒ„ì†Œ ì—¬ì „íˆ ë†’ìŒ (êµ¬ í‰ê·  +22%)<br>
          <b>ì„±ë™êµ¬</b> 3ê°œì›” ì—°ì† ê°€ì¥ ë¹ ë¥¸ ê°ì†Œì„¸
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== ESG SCORE ===================== -->
<div class="page" id="page-esg">
  <div class="ph">
    <div class="ph-tag">// Personal ESG Index Â· Carbon + Lifestyle + Social</div>
    <div class="ph-title">ê°œì¸ ESG ìŠ¤ì½”ì–´</div>
    <div class="ph-sub">íƒ„ì†Œ Â· ì‹í’ˆ ìœ í˜• Â· ì¬í™œìš© Â· ì†Œë¹„ ë¹ˆë„ë¥¼ ì¢…í•©í•œ ê°œì¸ ì§€ì†ê°€ëŠ¥ì„± ì§€ìˆ˜</div>
  </div>

  <div class="esg-hero">
    <div>
      <div class="esg-ring-wrap">
        <svg class="esg-ring-svg" viewBox="0 0 220 220">
          <defs>
            <filter id="glow"><feGaussianBlur stdDeviation="3" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter>
          </defs>
          <circle class="esg-ring-bg" cx="110" cy="110" r="90"/>
          <circle class="esg-ring-e" cx="110" cy="110" r="90" id="ringE"/>
          <circle class="esg-ring-s" cx="110" cy="110" r="75" id="ringS"/>
          <circle class="esg-ring-g" cx="110" cy="110" r="60" id="ringG"/>
        </svg>
        <div class="esg-center">
          <div class="esg-total" id="esgTotal">0</div>
          <div class="esg-label">ESG INDEX</div>
          <div style="margin-top:6px;font-family:'Bebas Neue',sans-serif;font-size:1.2rem;color:var(--amber)">B+</div>
        </div>
      </div>
      <div style="display:flex;gap:10px;margin-top:12px;justify-content:center;font-size:0.7rem;font-family:'DM Mono',monospace">
        <div style="display:flex;align-items:center;gap:4px"><div style="width:10px;height:10px;border-radius:50%;background:var(--green)"></div>Eí™˜ê²½</div>
        <div style="display:flex;align-items:center;gap:4px"><div style="width:10px;height:10px;border-radius:50%;background:var(--blue)"></div>Sì‚¬íšŒ</div>
        <div style="display:flex;align-items:center;gap:4px"><div style="width:10px;height:10px;border-radius:50%;background:var(--amber)"></div>Gê±°ë²„ë„ŒìŠ¤</div>
      </div>
    </div>

    <div class="esg-breakdown">
      <div class="esg-metric">
        <div class="esg-metric-row">
          <div class="esg-metric-name">ğŸŒ E â€” í™˜ê²½ (Environment)</div>
          <div class="esg-metric-score" style="color:var(--green)">82</div>
        </div>
        <div class="pbar-bg"><div class="pbar-fill" style="width:0%;background:var(--green)" id="barE"></div></div>
        <div class="esg-metric-desc" style="margin-top:8px">íƒ„ì†Œ ë°°ì¶œ ê°ì†Œ ì¶”ì„¸ ìš°ìˆ˜. ì‹ë¬¼ì„± ì†Œë¹„ ë¹„ìœ¨ 41%. ì¬í™œìš© ì¸ì¦ ì œí’ˆ êµ¬ë§¤ ì›” 3íšŒ.</div>
      </div>
      <div class="esg-metric">
        <div class="esg-metric-row">
          <div class="esg-metric-name">ğŸ¤ S â€” ì‚¬íšŒ (Social)</div>
          <div class="esg-metric-score" style="color:var(--blue)">74</div>
        </div>
        <div class="pbar-bg"><div class="pbar-fill" style="width:0%;background:var(--blue)" id="barS"></div></div>
        <div class="esg-metric-desc" style="margin-top:8px">ê³µì •ë¬´ì—­ ì œí’ˆ êµ¬ë§¤ ë¹„ìœ¨ ë³´í†µ. ì§€ì—­ ë†ì‚°ë¬¼ êµ¬ë§¤ ë‚®ìŒ. ì‚¬íšŒì  ê¸°ì—… ì°¸ì—¬ 2íšŒ.</div>
      </div>
      <div class="esg-metric">
        <div class="esg-metric-row">
          <div class="esg-metric-name">âš–ï¸ G â€” ê±°ë²„ë„ŒìŠ¤ (Governance)</div>
          <div class="esg-metric-score" style="color:var(--amber)">68</div>
        </div>
        <div class="pbar-bg"><div class="pbar-fill" style="width:0%;background:var(--amber)" id="barG"></div></div>
        <div class="esg-metric-desc" style="margin-top:8px">íƒ„ì†Œ ëª©í‘œ ì„¤ì • ì™„ë£Œ. ë°ì´í„° ê³µìœ  ë™ì˜. ì±Œë¦°ì§€ ì°¸ì—¬ìœ¨ 75%. ê¸°ë¶€ ìº í˜ì¸ ë¯¸ì°¸ì—¬.</div>
      </div>
    </div>
  </div>

  <div class="g2 gap">
    <div class="type-card">
      <div class="type-emoji">ğŸŒ¿</div>
      <div class="type-name">Flexitarianí˜•</div>
      <div class="type-desc">
        ìœ¡ë¥˜ë¥¼ ì™„ì „íˆ ëŠì§€ëŠ” ì•Šì§€ë§Œ ì˜ì‹ì ìœ¼ë¡œ ì¤„ì´ëŠ” ìœ í˜•.<br>
        ì‹ë¬¼ì„± ì†Œë¹„ ë¹„ìœ¨ 41% Â· ì£¼ 1~2íšŒ ìœ¡ë¥˜ êµ¬ë§¤.<br>
        <span style="color:var(--green)">ì „ì²´ ì‚¬ìš©ì ìƒìœ„ 23%</span>ì— í•´ë‹¹í•©ë‹ˆë‹¤.
      </div>
    </div>

    <div class="card">
      <div class="card-title">// ì†Œë¹„ êµ¬ì¡° í´ëŸ¬ìŠ¤í„° (ì„œìš¸ ì „ì²´)</div>
      <div class="cluster-map" id="clusterMap"></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">// ESG ì ìˆ˜ ë³€ë™ ì´ë ¥ (6ê°œì›”)</div>
    <div style="display:flex;gap:12px;align-items:flex-end;height:100px" id="esgHistoryChart"></div>
    <div style="margin-top:12px;font-size:0.75rem;color:var(--muted);line-height:1.6">
      ğŸ’¡ <b style="color:var(--text)">ì ìˆ˜ ì˜¬ë¦¬ëŠ” íŒ:</b> ì§€ì—­ ë†ì‚°ë¬¼ êµ¬ë§¤ ëŠ˜ë¦¬ê¸°(+S), ë‚˜ë¬´ ì‹¬ê¸° ê¸°ë¶€ ì°¸ì—¬(+G), ì´ë²ˆ ë‹¬ ëª©í‘œ ë‹¬ì„±(+E)
    </div>
  </div>
</div>

<!-- ===================== PREDICTION ===================== -->
<div class="page" id="page-pred">
  <div class="ph">
    <div class="ph-tag">// Behavioral Prediction Model Â· Linear Regression + Bayesian</div>
    <div class="ph-title">í–‰ë™ ì˜ˆì¸¡ ëª¨ë¸</div>
    <div class="ph-sub">ê³¼ê±° ì†Œë¹„ íŒ¨í„´ ê¸°ë°˜ ì›”ë§ íƒ„ì†Œ ë°°ì¶œ ì˜ˆì¸¡ Â· ì‹œë‚˜ë¦¬ì˜¤ë³„ ê²°ê³¼ ì‹œë®¬ë ˆì´ì…˜</div>
  </div>

  <div class="pred-layout">
    <div>
      <!-- ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ -->
      <div class="card gap">
        <div class="card-title">// ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ</div>
        <div class="scenario-list">
          <div class="scenario-item active" onclick="selectScenario(this,'base')">
            <div class="sc-info">
              <div class="sc-name">í˜„ì¬ ì¶”ì„¸ ìœ ì§€</div>
              <div class="sc-desc">ì§€ê¸ˆ íŒ¨í„´ ê·¸ëŒ€ë¡œ æœˆë§ê¹Œì§€</div>
            </div>
            <div class="sc-impact delta-warn" style="padding:4px 10px;border-radius:50px">58.2 kg</div>
          </div>
          <div class="scenario-item" onclick="selectScenario(this,'meat_cut')">
            <div class="sc-info">
              <div class="sc-name">ğŸ¥© ìœ¡ë¥˜ 1íšŒ ê°ì†Œ</div>
              <div class="sc-desc">ì´ë²ˆ ì£¼ ì‚¼ê²¹ì‚´ 1íšŒ ëœ êµ¬ë§¤</div>
            </div>
            <div class="sc-impact delta-good" style="padding:4px 10px;border-radius:50px">-3.8 kg</div>
          </div>
          <div class="scenario-item" onclick="selectScenario(this,'eco_switch')">
            <div class="sc-info">
              <div class="sc-name">ğŸŒ¿ ì¹œí™˜ê²½ ì œí’ˆ ì „í™˜</div>
              <div class="sc-desc">ì„¸íƒìš©í’ˆ, ìƒí™œìš©í’ˆ ì¹œí™˜ê²½ ëŒ€ì²´</div>
            </div>
            <div class="sc-impact delta-good" style="padding:4px 10px;border-radius:50px">-2.1 kg</div>
          </div>
          <div class="scenario-item" onclick="selectScenario(this,'dining_out')">
            <div class="sc-info">
              <div class="sc-name">ğŸ½ï¸ ì™¸ì‹ 2íšŒ ì¶”ê°€</div>
              <div class="sc-desc">ì™¸ì‹ í¬í•¨ ì‹œ íƒ„ì†Œ ì¦ê°€ ì˜ˆì¸¡</div>
            </div>
            <div class="sc-impact delta-bad" style="padding:4px 10px;border-radius:50px">+4.6 kg</div>
          </div>
        </div>
      </div>

      <!-- ì˜ˆì¸¡ ì°¨íŠ¸ -->
      <div class="card gap">
        <div class="card-title">// ì›”ë³„ ì˜ˆì¸¡ ê³¡ì„ </div>
        <svg class="tl-svg" viewBox="0 0 500 180" style="height:180px">
          <defs>
            <linearGradient id="greenGrad" x1="0" x2="0" y1="0" y2="1">
              <stop offset="0%" stop-color="#39ff88" stop-opacity="0.3"/>
              <stop offset="100%" stop-color="#39ff88" stop-opacity="0"/>
            </linearGradient>
          </defs>
          <!-- Goal line -->
          <line x1="0" y1="60" x2="500" y2="60" stroke="rgba(255,68,68,0.4)" stroke-width="1" stroke-dasharray="4,3"/>
          <text x="460" y="56" fill="rgba(255,68,68,0.7)" font-size="9" font-family="DM Mono">60kg</text>
          <!-- Actual path -->
          <polyline id="actualLine" points="0,140 83,130 166,95 250,120 333,85 416,80" fill="none" stroke="#39ff88" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
          <!-- Prediction path (dashed) -->
          <polyline id="predLine" points="416,80 500,65" fill="none" stroke="#ffcc00" stroke-width="2" stroke-dasharray="5,3" stroke-linecap="round"/>
          <!-- Scenario path (blue) -->
          <polyline id="scenarioLine" points="416,80 500,65" fill="none" stroke="#44aaff" stroke-width="2" stroke-dasharray="3,3" opacity="0"/>
          <!-- X labels -->
          <text x="0"   y="175" fill="rgba(90,128,90,1)" font-size="9" font-family="DM Mono">9ì›”</text>
          <text x="78"  y="175" fill="rgba(90,128,90,1)" font-size="9" font-family="DM Mono">10ì›”</text>
          <text x="161" y="175" fill="rgba(90,128,90,1)" font-size="9" font-family="DM Mono">11ì›”</text>
          <text x="245" y="175" fill="rgba(90,128,90,1)" font-size="9" font-family="DM Mono">12ì›”</text>
          <text x="328" y="175" fill="rgba(90,128,90,1)" font-size="9" font-family="DM Mono">1ì›”</text>
          <text x="408" y="175" fill="rgba(90,128,90,1)" font-size="9" font-family="DM Mono">2ì›”â–²</text>
          <text x="480" y="175" fill="rgba(255,204,0,0.8)" font-size="9" font-family="DM Mono">ì˜ˆì¸¡</text>
        </svg>
        <div style="display:flex;gap:16px;font-size:0.7rem;font-family:'DM Mono',monospace;margin-top:4px">
          <div style="display:flex;align-items:center;gap:5px"><div style="width:14px;height:2px;background:var(--green)"></div>ì‹¤ì œ ë°°ì¶œ</div>
          <div style="display:flex;align-items:center;gap:5px"><div style="width:14px;height:2px;background:var(--amber);opacity:0.7"></div>ê¸°ë³¸ ì˜ˆì¸¡</div>
          <div style="display:flex;align-items:center;gap:5px"><div style="width:14px;height:2px;background:var(--blue);opacity:0.8"></div>ì‹œë‚˜ë¦¬ì˜¤ ì ìš©</div>
        </div>
      </div>

      <!-- ì¸ì‚¬ì´íŠ¸ -->
      <div id="insightBox">
        <div class="insight-box">
          í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ <b>58.2 kg</b> ì˜ˆì¸¡. ëª©í‘œ 60kgê¹Œì§€ <b>1.8kg ì—¬ìœ </b> ìˆìŠµë‹ˆë‹¤.
        </div>
        <div class="insight-box warn">
          âš ï¸ ì§€ë‚œ 4ì£¼ê°„ ê¸ˆìš”ì¼ ì €ë… ì™¸ì‹ì´ íƒ„ì†Œ ì¦ê°€ì˜ <b>38%</b>ë¥¼ ì°¨ì§€í•©ë‹ˆë‹¤.
        </div>
      </div>
    </div>

    <div>
      <div class="prob-display card gap" style="padding:28px">
        <div style="font-family:'DM Mono',monospace;font-size:0.65rem;color:var(--muted);text-transform:uppercase;letter-spacing:0.1em;margin-bottom:8px">ëª©í‘œ ì´ˆê³¼ í™•ë¥ </div>
        <div class="prob-num" id="probNum">28%</div>
        <div class="prob-label">í˜„ì¬ ì‹œë‚˜ë¦¬ì˜¤ ê¸°ì¤€</div>
        <div style="margin-top:16px;height:6px;background:rgba(255,255,255,0.05);border-radius:3px;overflow:hidden">
          <div id="probBar" style="height:100%;width:28%;background:linear-gradient(90deg,var(--green),var(--amber));border-radius:3px;transition:width 0.8s"></div>
        </div>
      </div>

      <div class="card gap">
        <div class="card-title">// ì˜ˆì¸¡ ëª¨ë¸ ì •ë³´</div>
        <div style="font-size:0.75rem;color:var(--muted);line-height:1.8">
          <div>ğŸ“ ì„ í˜• íšŒê·€ (6ê°œì›” ë°ì´í„°)</div>
          <div>ğŸ² Bayesian ì—…ë°ì´íŠ¸ (ì£¼ê°„)</div>
          <div>ğŸ“Š Feature: ìš”ì¼Â·ì¹´í…Œê³ ë¦¬Â·ë‚ ì”¨</div>
          <div style="margin-top:8px;color:var(--text)">ëª¨ë¸ ì •í™•ë„ (RMSE)</div>
          <div style="font-family:'Bebas Neue',sans-serif;font-size:1.8rem;color:var(--green)">Â±2.4 kg</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">// ìš”ì¼ë³„ ì†Œë¹„ íŒ¨í„´</div>
        <div style="display:flex;align-items:flex-end;gap:5px;height:80px">
          <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;height:100%;justify-content:flex-end">
            <div style="font-size:0.6rem;color:var(--muted);font-family:'DM Mono',monospace">8.2</div>
            <div style="width:100%;background:rgba(57,255,136,0.3);border-radius:3px 3px 0 0;height:55%"></div>
            <div style="font-size:0.6rem;color:var(--muted)">ì›”</div>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;height:100%;justify-content:flex-end">
            <div style="font-size:0.6rem;color:var(--muted);font-family:'DM Mono',monospace">6.1</div>
            <div style="width:100%;background:rgba(57,255,136,0.3);border-radius:3px 3px 0 0;height:40%"></div>
            <div style="font-size:0.6rem;color:var(--muted)">í™”</div>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;height:100%;justify-content:flex-end">
            <div style="font-size:0.6rem;color:var(--muted);font-family:'DM Mono',monospace">5.8</div>
            <div style="width:100%;background:rgba(57,255,136,0.3);border-radius:3px 3px 0 0;height:38%"></div>
            <div style="font-size:0.6rem;color:var(--muted)">ìˆ˜</div>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;height:100%;justify-content:flex-end">
            <div style="font-size:0.6rem;color:var(--muted);font-family:'DM Mono',monospace">7.4</div>
            <div style="width:100%;background:rgba(57,255,136,0.3);border-radius:3px 3px 0 0;height:49%"></div>
            <div style="font-size:0.6rem;color:var(--muted)">ëª©</div>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;height:100%;justify-content:flex-end">
            <div style="font-size:0.6rem;color:var(--muted);font-family:'DM Mono',monospace">14.6</div>
            <div style="width:100%;background:rgba(255,68,68,0.5);border-radius:3px 3px 0 0;height:97%"></div>
            <div style="font-size:0.6rem;color:var(--red)">ê¸ˆğŸ”¥</div>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;height:100%;justify-content:flex-end">
            <div style="font-size:0.6rem;color:var(--muted);font-family:'DM Mono',monospace">11.2</div>
            <div style="width:100%;background:rgba(255,204,0,0.4);border-radius:3px 3px 0 0;height:74%"></div>
            <div style="font-size:0.6rem;color:var(--muted)">í† </div>
          </div>
          <div style="flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;height:100%;justify-content:flex-end">
            <div style="font-size:0.6rem;color:var(--muted);font-family:'DM Mono',monospace">9.3</div>
            <div style="width:100%;background:rgba(57,255,136,0.3);border-radius:3px 3px 0 0;height:62%"></div>
            <div style="font-size:0.6rem;color:var(--muted)">ì¼</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===================== POLICY SIM ===================== -->
<div class="page" id="page-policy">
  <div class="ph">
    <div class="ph-tag">// Policy Simulation Lab Â· User Data Based</div>
    <div class="ph-title">ì •ì±… ì‹¤í—˜ì‹¤</div>
    <div class="ph-sub">ë‚´ ì†Œë¹„ ë°ì´í„° ê¸°ë°˜ ê°€ìƒ ì •ì±… ì‹œë®¬ë ˆì´ì…˜ Â· "ë§Œì•½ ì„œìš¸ì‹œê°€ ì´ ì •ì±…ì„ ì‹œí–‰í•œë‹¤ë©´?"</div>
  </div>

  <div class="policy-layout">
    <div>
      <div class="policy-list">
        <div class="policy-item active" onclick="selectPolicy(this,'meat_tax')">
          <div class="policy-header">
            <div class="policy-icon">ğŸ¥©</div>
            <div>
              <div class="policy-title">ìœ¡ë¥˜ ì†Œë¹„ í™˜ê²½ì„¸</div>
              <div class="policy-subtitle">ìœ¡ë¥˜ ì œí’ˆ êµ¬ë§¤ ì‹œ íƒ„ì†Œì„¸ ë¶€ê³¼</div>
            </div>
          </div>
          <div class="slider-wrap">
            <div class="slider-label"><span>ì„¸ìœ¨</span><span id="meatTaxVal">5%</span></div>
            <input type="range" min="1" max="30" value="5" oninput="updateSlider(this,'meatTaxVal','%');calcPolicy()" style="--val:17%">
          </div>
        </div>

        <div class="policy-item" onclick="selectPolicy(this,'eco_subsidy')">
          <div class="policy-header">
            <div class="policy-icon">ğŸŒ¿</div>
            <div>
              <div class="policy-title">ì¹œí™˜ê²½ ì œí’ˆ êµ¬ë§¤ ë³´ì¡°ê¸ˆ</div>
              <div class="policy-subtitle">ì¹œí™˜ê²½ ì¸ì¦ ì œí’ˆ êµ¬ë§¤ ì‹œ í• ì¸ ì§€ì›</div>
            </div>
          </div>
          <div class="slider-wrap">
            <div class="slider-label"><span>ë³´ì¡°ìœ¨</span><span id="ecoSubVal">10%</span></div>
            <input type="range" min="5" max="50" value="10" oninput="updateSlider(this,'ecoSubVal','%');calcPolicy()" style="--val:11%">
          </div>
        </div>

        <div class="policy-item" onclick="selectPolicy(this,'carbon_quota')">
          <div class="policy-header">
            <div class="policy-icon">ğŸ“Š</div>
            <div>
              <div class="policy-title">ê°œì¸ íƒ„ì†Œ ì¿¼í„°ì œ</div>
              <div class="policy-subtitle">ì›” íƒ„ì†Œ í•œë„ ì´ˆê³¼ ì‹œ ì¶”ê°€ ë¹„ìš©</div>
            </div>
          </div>
          <div class="slider-wrap">
            <div class="slider-label"><span>ì›” í•œë„</span><span id="quotaVal">60 kg</span></div>
            <input type="range" min="30" max="100" value="60" oninput="updateSlider(this,'quotaVal',' kg');calcPolicy()" style="--val:33%">
          </div>
        </div>

        <div class="policy-item" onclick="selectPolicy(this,'local_food')">
          <div class="policy-header">
            <div class="policy-icon">ğŸ˜ï¸</div>
            <div>
              <div class="policy-title">ì§€ì—­ ë†ì‚°ë¬¼ ìš°ì„  ì •ì±…</div>
              <div class="policy-subtitle">ë¡œì»¬í‘¸ë“œ êµ¬ë§¤ ì‹œ íƒ„ì†Œ í¬ì¸íŠ¸ 2ë°°</div>
            </div>
          </div>
          <div class="slider-wrap">
            <div class="slider-label"><span>ì¸ì„¼í‹°ë¸Œ</span><span id="localVal">2x</span></div>
            <input type="range" min="1" max="5" value="2" oninput="updateSlider(this,'localVal','x');calcPolicy()" style="--val:25%">
          </div>
        </div>
      </div>
    </div>

    <div class="sim-result-card">
      <div class="card-title">// ë‚˜ì—ê²Œ ë¯¸ì¹˜ëŠ” ì˜í–¥ ì‹œë®¬ë ˆì´ì…˜</div>

      <div class="sim-before-after">
        <div class="sim-side before">
          <div class="sim-side-val" style="color:var(--red)">42.7</div>
          <div style="font-size:0.55rem;font-family:'DM Mono',monospace;color:var(--muted)">kg COâ‚‚e</div>
          <div class="sim-side-label">í˜„ì¬</div>
        </div>
        <div class="sim-side after">
          <div class="sim-side-val" style="color:var(--green)" id="simAfterVal">39.1</div>
          <div style="font-size:0.55rem;font-family:'DM Mono',monospace;color:var(--muted)">kg COâ‚‚e</div>
          <div class="sim-side-label">ì •ì±… ì ìš© í›„</div>
        </div>
      </div>

      <div class="impact-bars">
        <div class="impact-row">
          <div class="impact-name"><span>íƒ„ì†Œ ì ˆê°</span><span id="impactCO2">-3.6 kg</span></div>
          <div class="pbar-bg"><div class="pbar-fill" id="impactCO2Bar" style="width:60%;background:var(--green)"></div></div>
        </div>
        <div class="impact-row">
          <div class="impact-name"><span>ì¶”ê°€ ë¹„ìš©</span><span id="impactCost">+2,800ì›/ì›”</span></div>
          <div class="pbar-bg"><div class="pbar-fill" id="impactCostBar" style="width:35%;background:var(--red)"></div></div>
        </div>
        <div class="impact-row">
          <div class="impact-name"><span>í–‰ë™ ë³€í™” ì˜ˆì¸¡</span><span id="impactBehavior">ìœ¡ë¥˜ 1.2íšŒâ†“</span></div>
          <div class="pbar-bg"><div class="pbar-fill" id="impactBehaviorBar" style="width:48%;background:var(--blue)"></div></div>
        </div>
      </div>

      <div style="margin-top:16px;padding:12px;background:var(--bg3);border-radius:var(--r-sm);font-size:0.75rem;color:var(--muted);line-height:1.6" id="policyComment">
        ğŸ¥© ìœ¡ë¥˜ í™˜ê²½ì„¸ 5% ë¶€ê³¼ ì‹œ, í˜„ì¬ ì†Œë¹„ íŒ¨í„´ ê¸°ì¤€ìœ¼ë¡œ ì›” <b style="color:var(--text)">2,800ì›</b> ì¶”ê°€ ë¹„ìš©ì´ ë°œìƒí•©ë‹ˆë‹¤. í–‰ë™ê²½ì œí•™ ëª¨ë¸ ê¸°ë°˜ìœ¼ë¡œ ìœ¡ë¥˜ êµ¬ë§¤ <b style="color:var(--green)">1.2íšŒ ê°ì†Œ</b> ì˜ˆì¸¡.
      </div>

      <div style="margin-top:16px">
        <div style="font-family:'DM Mono',monospace;font-size:0.65rem;color:var(--muted);margin-bottom:8px;text-transform:uppercase;letter-spacing:0.1em">ì„œìš¸ì‹œ ì „ì²´ íš¨ê³¼ ì¶”ì‚°</div>
        <div style="display:flex;gap:12px">
          <div style="text-align:center;flex:1">
            <div style="font-family:'Bebas Neue',sans-serif;font-size:1.6rem;color:var(--green)" id="cityImpact">-89k</div>
            <div style="font-size:0.65rem;color:var(--muted)">í†¤ COâ‚‚/ë…„</div>
          </div>
          <div style="text-align:center;flex:1">
            <div style="font-family:'Bebas Neue',sans-serif;font-size:1.6rem;color:var(--blue)">24,891</div>
            <div style="font-size:0.65rem;color:var(--muted)">ëª… ê¸°ì¤€</div>
          </div>
        </div>
      </div>

      <button class="btn btn-o" style="width:100%;margin-top:16px;font-size:0.75rem" onclick="showToast('ğŸ“‹ ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ê°€ ì •ì±… ë¦¬í¬íŠ¸ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!')">ğŸ“‹ ì •ì±… ë¦¬í¬íŠ¸ ì €ì¥</button>
    </div>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CORE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function go(id, el) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + id).classList.add('active');
  if (el) el.classList.add('active');
  if (id === 'map')    initMap();
  if (id === 'esg')    initESG();
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3200);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DASHBOARD
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const dashMonths = ['9ì›”','10ì›”','11ì›”','12ì›”','1ì›”','2ì›”','ì˜ˆì¸¡'];
const dashVals   = [68, 72, 55, 80, 49, 43, 58];
const isPred     = [0,0,0,0,0,0,1];

function renderDashChart() {
  const el = document.getElementById('dashChart');
  el.innerHTML = '';
  const max = Math.max(...dashVals);
  dashMonths.forEach((m, i) => {
    const h = Math.round((dashVals[i] / max) * 120);
    const color = isPred[i] ? 'rgba(255,204,0,0.5)' : (dashVals[i] > 65 ? '#ff4444' : dashVals[i] > 50 ? '#ffcc00' : '#39ff88');
    const border = isPred[i] ? '1px dashed rgba(255,204,0,0.6)' : 'none';
    const d = document.createElement('div');
    d.style.cssText = 'flex:1;display:flex;flex-direction:column;align-items:center;gap:4px;height:100%;justify-content:flex-end';
    d.innerHTML = `
      <div style="font-family:'DM Mono',monospace;font-size:0.62rem;color:var(--muted)">${dashVals[i]}</div>
      <div style="width:100%;background:${color};border-radius:3px 3px 0 0;height:${h}px;border:${border}"></div>
      <div style="font-size:0.62rem;color:${isPred[i]?'var(--amber)':'var(--muted)'}">${m}</div>
    `;
    el.appendChild(d);
  });
}

// Prediction fill animate
setTimeout(() => {
  const pf = document.getElementById('predFill');
  if (pf) pf.style.width = '72%'; // 58.2/80
}, 400);

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// SEOUL MAP DATA
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const GU_DATA = {
  'ì¢…ë¡œêµ¬':{'co2':58.2,'rank':8,'food':45,'living':35,'clothing':20,'trend':-2.1},
  'ì¤‘êµ¬':{'co2':61.4,'rank':14,'food':50,'living':30,'clothing':20,'trend':+0.3},
  'ìš©ì‚°êµ¬':{'co2':67.8,'rank':21,'food':52,'living':28,'clothing':20,'trend':-1.2},
  'ì„±ë™êµ¬':{'co2':54.1,'rank':3,'food':40,'living':38,'clothing':22,'trend':-5.8},
  'ê´‘ì§„êµ¬':{'co2':59.3,'rank':10,'food':44,'living':36,'clothing':20,'trend':-3.1},
  'ë™ëŒ€ë¬¸êµ¬':{'co2':62.7,'rank':17,'food':48,'living':32,'clothing':20,'trend':+1.1},
  'ì¤‘ë‘êµ¬':{'co2':60.1,'rank':11,'food':46,'living':34,'clothing':20,'trend':-0.5},
  'ì„±ë¶êµ¬':{'co2':56.8,'rank':6,'food':43,'living':36,'clothing':21,'trend':-2.9},
  'ê°•ë¶êµ¬':{'co2':55.3,'rank':4,'food':42,'living':37,'clothing':21,'trend':-3.4},
  'ë„ë´‰êµ¬':{'co2':53.9,'rank':2,'food':41,'living':38,'clothing':21,'trend':-4.1},
  'ë…¸ì›êµ¬':{'co2':57.4,'rank':7,'food':44,'living':36,'clothing':20,'trend':-2.5},
  'ì€í‰êµ¬':{'co2':58.9,'rank':9,'food':45,'living':35,'clothing':20,'trend':-1.8},
  'ì„œëŒ€ë¬¸êµ¬':{'co2':60.5,'rank':12,'food':46,'living':33,'clothing':21,'trend':-0.8},
  'ë§ˆí¬êµ¬':{'co2':52.3,'rank':1,'food':38,'living':40,'clothing':22,'trend':-6.2},
  'ì–‘ì²œêµ¬':{'co2':61.8,'rank':15,'food':47,'living':32,'clothing':21,'trend':+0.5},
  'ê°•ì„œêµ¬':{'co2':63.2,'rank':18,'food':49,'living':30,'clothing':21,'trend':+1.3},
  'êµ¬ë¡œêµ¬':{'co2':64.1,'rank':19,'food':50,'living':29,'clothing':21,'trend':+1.8},
  'ê¸ˆì²œêµ¬':{'co2':65.7,'rank':20,'food':51,'living':28,'clothing':21,'trend':+2.3},
  'ì˜ë“±í¬êµ¬':{'co2':68.3,'rank':22,'food':53,'living':27,'clothing':20,'trend':+2.8},
  'ë™ì‘êµ¬':{'co2':56.1,'rank':5,'food':43,'living':37,'clothing':20,'trend':-3.0},
  'ê´€ì•…êµ¬':{'co2':60.9,'rank':13,'food':47,'living':33,'clothing':20,'trend':-0.6},
  'ì„œì´ˆêµ¬':{'co2':71.4,'rank':24,'food':56,'living':24,'clothing':20,'trend':+3.5},
  'ê°•ë‚¨êµ¬':{'co2':74.8,'rank':25,'food':59,'living':21,'clothing':20,'trend':+4.2},
  'ì†¡íŒŒêµ¬':{'co2':69.2,'rank':23,'food':54,'living':26,'clothing':20,'trend':+3.1},
  'ê°•ë™êµ¬':{'co2':62.1,'rank':16,'food':48,'living':32,'clothing':20,'trend':+0.8},
};

function co2Color(val) {
  const min = 52, max = 75;
  const t = Math.max(0, Math.min(1, (val - min) / (max - min)));
  if (t < 0.25) return `rgba(30,128,56,${0.4+t*1.5})`;
  if (t < 0.5)  return `rgba(57,255,136,${0.3+t})`;
  if (t < 0.75) return `rgba(255,204,0,${0.4+t*0.5})`;
  return `rgba(255,68,68,${0.5+t*0.5})`;
}

let mapMode = 'total';
let selectedGu = null;
let mapInited = false;

// Simplified Seoul SVG paths (approximate polygon per gu)
const GU_PATHS = {
  'ì¢…ë¡œêµ¬':'M190,80 L220,75 L235,95 L215,120 L195,115 L185,100 Z',
  'ì¤‘êµ¬':'M215,120 L235,95 L255,105 L250,130 L225,135 Z',
  'ìš©ì‚°êµ¬':'M195,115 L215,120 L225,135 L210,155 L185,145 L180,130 Z',
  'ì„±ë™êµ¬':'M250,130 L280,120 L295,140 L275,160 L250,155 L235,140 Z',
  'ê´‘ì§„êµ¬':'M280,120 L310,115 L325,135 L305,155 L275,160 Z',
  'ë™ëŒ€ë¬¸êµ¬':'M255,105 L285,98 L300,115 L280,120 L250,130 Z',
  'ì¤‘ë‘êµ¬':'M285,98 L315,90 L330,110 L310,115 L285,98 Z',
  'ì„±ë¶êµ¬':'M220,75 L255,68 L270,88 L255,105 L235,95 Z',
  'ê°•ë¶êµ¬':'M175,60 L210,55 L220,75 L190,80 L175,70 Z',
  'ë„ë´‰êµ¬':'M175,30 L210,25 L215,55 L175,60 Z',
  'ë…¸ì›êµ¬':'M210,25 L250,22 L260,60 L215,55 Z',
  'ì€í‰êµ¬':'M140,55 L175,30 L175,70 L155,85 L135,75 Z',
  'ì„œëŒ€ë¬¸êµ¬':'M155,85 L175,70 L190,80 L185,100 L160,105 Z',
  'ë§ˆí¬êµ¬':'M130,100 L160,105 L185,100 L180,130 L155,140 L125,125 Z',
  'ì–‘ì²œêµ¬':'M90,145 L125,140 L130,165 L100,170 Z',
  'ê°•ì„œêµ¬':'M70,115 L105,110 L125,125 L130,145 L90,145 L75,135 Z',
  'êµ¬ë¡œêµ¬':'M90,165 L125,165 L130,185 L95,190 Z',
  'ê¸ˆì²œêµ¬':'M95,190 L130,185 L132,205 L100,210 Z',
  'ì˜ë“±í¬êµ¬':'M130,145 L155,140 L165,160 L145,175 L125,165 Z',
  'ë™ì‘êµ¬':'M155,140 L180,130 L185,145 L175,165 L155,165 L145,160 Z',
  'ê´€ì•…êµ¬':'M145,175 L165,160 L175,165 L170,190 L145,195 Z',
  'ì„œì´ˆêµ¬':'M175,165 L210,155 L225,170 L215,200 L175,195 Z',
  'ê°•ë‚¨êµ¬':'M210,155 L245,150 L255,165 L245,195 L215,200 Z',
  'ì†¡íŒŒêµ¬':'M245,150 L280,148 L285,170 L260,185 L245,180 Z',
  'ê°•ë™êµ¬':'M280,148 L315,145 L315,170 L285,175 Z',
};

function initMap() {
  if (mapInited) return;
  mapInited = true;
  renderMap();
  renderDistrictRanking();
  renderCityChart();
}

function renderMap() {
  const container = document.getElementById('seoulMap');
  let svg = `<svg viewBox="55 15 280 210" xmlns="http://www.w3.org/2000/svg">`;
  Object.entries(GU_PATHS).forEach(([name, path]) => {
    const d = GU_DATA[name];
    const fill = co2Color(d.co2);
    svg += `<path class="gu-path" d="${path}" fill="${fill}" id="gu-${name}" onclick="selectGu('${name}')" data-name="${name}">
      <title>${name} ${d.co2}kg COâ‚‚e</title>
    </path>`;
  });
  // Labels for major gu
  ['ë§ˆí¬êµ¬','ê°•ë‚¨êµ¬','ì¢…ë¡œêµ¬','ë…¸ì›êµ¬','ê°•ì„œêµ¬','ì„±ë™êµ¬'].forEach(name => {
    const pathEl = GU_PATHS[name];
    const coords = pathEl.match(/[\d.]+,[\d.]+/g);
    let cx = 0, cy = 0;
    coords.forEach(c => { const [x,y] = c.split(','); cx += +x; cy += +y; });
    cx = Math.round(cx / coords.length); cy = Math.round(cy / coords.length);
    svg += `<text x="${cx}" y="${cy}" text-anchor="middle" dominant-baseline="middle" fill="rgba(255,255,255,0.6)" font-size="6" font-family="Noto Sans KR" pointer-events="none" style="font-weight:500">${name.replace('êµ¬','')}</text>`;
  });
  svg += '</svg>';
  container.innerHTML = svg;
}

function setMapMode(mode, el) {
  mapMode = mode;
  document.querySelectorAll('#page-map .badge,[id^=filter]').forEach(e => {
    e.style.background = 'var(--bg3)';
    e.style.color = 'var(--muted)';
    e.style.borderColor = 'var(--border)';
  });
  el.style.background = 'var(--green-dim)';
  el.style.color = 'var(--green)';
  el.style.borderColor = 'var(--border2)';
}

function selectGu(name) {
  selectedGu = name;
  document.querySelectorAll('.gu-path').forEach(p => p.classList.remove('selected'));
  const pathEl = document.getElementById('gu-' + name);
  if (pathEl) pathEl.classList.add('selected');
  renderGuPanel(name);
  document.querySelectorAll('.district-item').forEach(d => {
    d.classList.toggle('selected', d.dataset.gu === name);
  });
}

function renderGuPanel(name) {
  const d = GU_DATA[name];
  const color = d.co2 > 65 ? 'var(--red)' : d.co2 > 58 ? 'var(--amber)' : 'var(--green)';
  const trendStr = d.trend > 0 ? `â†‘ +${d.trend}%` : `â†“ ${d.trend}%`;
  const trendColor = d.trend > 0 ? 'var(--red)' : 'var(--green)';
  const panel = document.getElementById('guPanel');
  panel.innerHTML = `
    <div class="gu-name">${name}</div>
    <div style="display:flex;align-items:baseline;gap:6px;margin-top:8px">
      <div class="gu-co2" style="color:${color}">${d.co2}</div>
      <div style="font-size:0.75rem;color:var(--muted)">kg COâ‚‚e/ì›”</div>
    </div>
    <div class="gu-rank">ì„œìš¸ ${d.rank}ìœ„ / 25ê°œ ìì¹˜êµ¬</div>
    <div style="margin-top:8px;font-size:0.75rem;color:${trendColor};font-family:'DM Mono',monospace">${trendStr} ì „ì›” ëŒ€ë¹„</div>
    <div class="gu-cats">
      <div class="gu-cat-row">
        <div class="gu-cat-name">ì‹í’ˆ</div>
        <div class="gu-cat-bar"><div class="gu-cat-fill" style="width:${d.food}%;background:#ff5252"></div></div>
        <div style="font-size:0.65rem;font-family:'DM Mono',monospace;color:var(--muted)">${d.food}%</div>
      </div>
      <div class="gu-cat-row">
        <div class="gu-cat-name">ìƒí™œìš©í’ˆ</div>
        <div class="gu-cat-bar"><div class="gu-cat-fill" style="width:${d.living}%;background:#ffcc00"></div></div>
        <div style="font-size:0.65rem;font-family:'DM Mono',monospace;color:var(--muted)">${d.living}%</div>
      </div>
      <div class="gu-cat-row">
        <div class="gu-cat-name">ì˜ë¥˜</div>
        <div class="gu-cat-bar"><div class="gu-cat-fill" style="width:${d.clothing}%;background:#44aaff"></div></div>
        <div style="font-size:0.65rem;font-family:'DM Mono',monospace;color:var(--muted)">${d.clothing}%</div>
      </div>
    </div>
    <div class="trend-note" style="margin-top:14px">
      ${d.co2 < 56 ? `<b>${name}</b>ì€ ì„œìš¸ ìµœìš°ìˆ˜ ì¹œí™˜ê²½ ìì¹˜êµ¬ì…ë‹ˆë‹¤. ì‹ë¬¼ì„± ì†Œë¹„ ë¹„ìœ¨ì´ íŠ¹íˆ ë†’ìŠµë‹ˆë‹¤.`
        : d.co2 > 68 ? `<b>${name}</b>ì€ ìœ¡ë¥˜ ì†Œë¹„ íƒ„ì†Œê°€ í‰ê·  ëŒ€ë¹„ ë†’ìŠµë‹ˆë‹¤. ì§€ì—­ ìº í˜ì¸ í•„ìš”.`
        : `<b>${name}</b>ì€ ì„œìš¸ í‰ê·  ìˆ˜ì¤€ì…ë‹ˆë‹¤. ê¾¸ì¤€í•œ ê°œì„ ì´ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.`}
    </div>
  `;
}

function renderDistrictRanking() {
  const sorted = Object.entries(GU_DATA).sort((a,b) => a[1].co2 - b[1].co2);
  const el = document.getElementById('districtRanking');
  el.innerHTML = '';
  sorted.forEach(([name, d], i) => {
    const color = d.co2 > 65 ? 'var(--red)' : d.co2 > 58 ? 'var(--amber)' : 'var(--green)';
    const div = document.createElement('div');
    div.className = 'district-item';
    div.dataset.gu = name;
    div.innerHTML = `<span style="color:var(--muted);font-family:'DM Mono',monospace">${i+1}</span><span>${name}</span><span style="color:${color};font-family:'DM Mono',monospace">${d.co2}</span>`;
    div.onclick = () => selectGu(name);
    el.appendChild(div);
  });
}

function renderCityChart() {
  const el = document.getElementById('cityChart');
  const months = ['9ì›”','10ì›”','11ì›”','12ì›”','1ì›”','2ì›”'];
  const vals   = [68.2, 70.1, 65.4, 72.3, 64.8, 63.4];
  const max    = Math.max(...vals);
  el.innerHTML = '';
  months.forEach((m, i) => {
    const h = Math.round((vals[i] / max) * 70);
    const color = vals[i] > 68 ? 'rgba(255,68,68,0.5)' : 'rgba(57,255,136,0.4)';
    const d = document.createElement('div');
    d.style.cssText = 'flex:1;display:flex;flex-direction:column;align-items:center;gap:3px;height:100%;justify-content:flex-end';
    d.innerHTML = `
      <div style="font-size:0.58rem;color:var(--muted);font-family:'DM Mono',monospace">${vals[i]}</div>
      <div style="width:100%;background:${color};border-radius:2px 2px 0 0;height:${h}px"></div>
      <div style="font-size:0.58rem;color:var(--muted)">${m}</div>
    `;
    el.appendChild(d);
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ESG SCORE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const CLUSTERS = [
  {emoji:'ğŸ¥—',name:'ì±„ì‹ì£¼ì˜í˜•',desc:'ì‹ë¬¼ì„± ìœ„ì£¼'},
  {emoji:'ğŸŒ¿',name:'Flexitarianí˜•',desc:'ì˜ì‹ì  ìœ¡ë¥˜ ê°ì†Œ',me:true},
  {emoji:'ğŸ›’',name:'í¸ì˜ì£¼ì˜í˜•',desc:'í¸ì˜ì  ìœ„ì£¼'},
  {emoji:'â™»ï¸',name:'ì¬í™œìš©í˜•',desc:'ì œí’ˆ ì¬ì‚¬ìš© ë†’ìŒ'},
  {emoji:'ğŸ–',name:'High-Carboní˜•',desc:'ìœ¡ë¥˜ ì†Œë¹„ ë†’ìŒ'},
  {emoji:'ğŸŒ¾',name:'ë¡œì»¬í‘¸ë“œí˜•',desc:'ì§€ì—­ ë†ì‚°ë¬¼ ìœ„ì£¼'},
];

const ESG_HISTORY = [55,60,65,70,74,78];

function initESG() {
  // Ring animation
  setTimeout(() => {
    const circ = 2 * Math.PI * 90; // ~565
    document.getElementById('ringE').style.strokeDashoffset = circ * (1 - 82/100);
    document.getElementById('ringS').style.strokeDashoffset = circ * (1 - 74/100);
    document.getElementById('ringG').style.strokeDashoffset = circ * (1 - 68/100);
    // Bar animation
    document.getElementById('barE').style.width = '82%';
    document.getElementById('barS').style.width = '74%';
    document.getElementById('barG').style.width = '68%';
  }, 200);

  // Count up total
  let n = 0;
  const target = 78;
  const tick = setInterval(() => {
    n = Math.min(n + 2, target);
    document.getElementById('esgTotal').textContent = n;
    if (n >= target) clearInterval(tick);
  }, 20);

  // Cluster
  const el = document.getElementById('clusterMap');
  el.innerHTML = '';
  CLUSTERS.forEach(c => {
    const d = document.createElement('div');
    d.className = 'cluster-dot' + (c.me ? ' me' : '');
    d.innerHTML = `<div class="cluster-emoji">${c.emoji}</div><div style="font-size:0.65rem;font-weight:500;margin-bottom:2px">${c.name.replace('í˜•','')}</div><div style="font-size:0.58rem;color:var(--muted)">${c.desc}</div>${c.me ? '<div style="font-size:0.58rem;color:var(--green);margin-top:2px">â† ë‚˜</div>' : ''}`;
    el.appendChild(d);
  });

  // ESG history
  const hel = document.getElementById('esgHistoryChart');
  hel.innerHTML = '';
  const maxH = Math.max(...ESG_HISTORY);
  const months = ['9ì›”','10ì›”','11ì›”','12ì›”','1ì›”','2ì›”'];
  ESG_HISTORY.forEach((v, i) => {
    const h = Math.round((v / maxH) * 80);
    const d = document.createElement('div');
    d.style.cssText = 'flex:1;display:flex;flex-direction:column;align-items:center;gap:3px;height:100%;justify-content:flex-end';
    d.innerHTML = `
      <div style="font-size:0.6rem;color:var(--muted);font-family:'DM Mono',monospace">${v}</div>
      <div style="width:100%;background:${i===5?'var(--green)':'rgba(57,255,136,0.3)'};border-radius:3px 3px 0 0;height:${h}px"></div>
      <div style="font-size:0.6rem;color:var(--muted)">${months[i]}</div>
    `;
    hel.appendChild(d);
  });
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// PREDICTION
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const scenarios = {
  base:       { prob: 28, pred: '500,65',  color: '#ffcc00', label: 'í˜„ì¬ ì¶”ì„¸' },
  meat_cut:   { prob: 9,  pred: '500,42',  color: '#39ff88', label: 'ìœ¡ë¥˜ ê°ì†Œ' },
  eco_switch: { prob: 15, pred: '500,50',  color: '#44aaff', label: 'ì¹œí™˜ê²½ ì „í™˜' },
  dining_out: { prob: 72, pred: '500,102', color: '#ff4444', label: 'ì™¸ì‹ ì¶”ê°€' },
};

const insightTexts = {
  base:       ['í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ <b>58.2 kg</b> ì˜ˆì¸¡. ëª©í‘œ 60kgê¹Œì§€ <b>1.8kg ì—¬ìœ </b>ìˆìŠµë‹ˆë‹¤.', 'âš ï¸ ì§€ë‚œ 4ì£¼ê°„ ê¸ˆìš”ì¼ ì €ë…ì´ íƒ„ì†Œ ì¦ê°€ì˜ <b>38%</b>ë¥¼ ì°¨ì§€í•©ë‹ˆë‹¤.'],
  meat_cut:   ['ìœ¡ë¥˜ 1íšŒ ì¤„ì´ë©´ ì›”ë§ <b>54.4 kg</b> ì˜ˆì¸¡. <b>ëª©í‘œ ë‹¬ì„± ê°€ëŠ¥</b>í•©ë‹ˆë‹¤!', 'ğŸ’¡ ì‚¼ê²¹ì‚´ 1íšŒë¥¼ ë‘ë¶€ ìš”ë¦¬ë¡œ ëŒ€ì²´í•˜ë©´ <b>3.8 kg</b> ì ˆê°ë©ë‹ˆë‹¤.'],
  eco_switch: ['ì¹œí™˜ê²½ ì „í™˜ ì‹œ <b>56.1 kg</b> ì˜ˆì¸¡. ìƒí™œìš©í’ˆ íƒ„ì†Œê°€ <b>18% ê°ì†Œ</b>í•©ë‹ˆë‹¤.', 'ğŸŒ¿ ìƒ´í‘¸ë°”Â·ë¬´í˜•ê´‘ ì„¸ì œ ì „í™˜ì´ ê°€ì¥ íš¨ê³¼ì ì…ë‹ˆë‹¤.'],
  dining_out: ['ì™¸ì‹ 2íšŒ ì¶”ê°€ ì‹œ <b>62.8 kg</b>ìœ¼ë¡œ <b>ëª©í‘œ ì´ˆê³¼</b> ì˜ˆì¸¡!', 'ğŸš¨ ì™¸ì‹ ì‹œ ìœ¡ë¥˜ ìœ„ì£¼ ë©”ë‰´ ì„ íƒì´ íƒ„ì†Œë¥¼ 3ë°° ì¦ê°€ì‹œí‚µë‹ˆë‹¤.'],
};

function selectScenario(el, key) {
  document.querySelectorAll('.scenario-item').forEach(s => s.classList.remove('active'));
  el.classList.add('active');
  const s = scenarios[key];
  document.getElementById('predLine').setAttribute('points', `416,80 ${s.pred}`);
  document.getElementById('scenarioLine').setAttribute('points', `416,80 ${s.pred}`);
  document.getElementById('scenarioLine').style.opacity = key === 'base' ? '0' : '0.8';
  document.getElementById('scenarioLine').style.stroke = s.color;
  document.getElementById('probNum').textContent = s.prob + '%';
  document.getElementById('probBar').style.width = s.prob + '%';
  document.getElementById('probBar').style.background = s.prob > 50 ? 'var(--red)' : s.prob > 25 ? 'var(--amber)' : 'var(--green)';
  const [t1, t2] = insightTexts[key];
  document.getElementById('insightBox').innerHTML = `
    <div class="insight-box">${t1}</div>
    <div class="insight-box ${key==='dining_out'?'warn':''}">${t2}</div>
  `;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// POLICY SIMULATION
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const policyData = {
  meat_tax:    { base: 42.7, perPct: 0.18, costPer: 560, behavPer: 0.06 },
  eco_subsidy: { base: 42.7, perPct: -0.12, costPer: -400, behavPer: 0.04 },
  carbon_quota:{ base: 42.7, perKg: 0.15, costPerKg: 300, behavPerKg: 0.03 },
  local_food:  { base: 42.7, perX: 0.8, costPerX: -200, behavPerX: 0.3 },
};

let currentPolicy = 'meat_tax';

function selectPolicy(el, key) {
  document.querySelectorAll('.policy-item').forEach(p => p.classList.remove('active'));
  el.classList.add('active');
  currentPolicy = key;
  calcPolicy();
}

function updateSlider(input, labelId, suffix) {
  document.getElementById(labelId).textContent = input.value + suffix;
  const pct = (input.value - input.min) / (input.max - input.min) * 100;
  input.style.setProperty('--val', pct + '%');
}

function calcPolicy() {
  const p = policyData[currentPolicy];
  let reduction = 0, cost = 0, behavior = 0;

  if (currentPolicy === 'meat_tax') {
    const rate = parseInt(document.querySelector('#page-policy input[type=range]')?.value || 5);
    reduction = p.perPct * rate;
    cost = p.costPer * rate;
    behavior = p.behavPer * rate;
  } else if (currentPolicy === 'eco_subsidy') {
    const rate = 10;
    reduction = Math.abs(p.perPct) * rate * 0.4;
    cost = p.costPer * rate * -1;
    behavior = p.behavPer * rate;
  } else if (currentPolicy === 'carbon_quota') {
    const quota = 60;
    const over = Math.max(0, 42.7 - quota + 5);
    reduction = over * p.perKg;
    cost = over * p.costPerKg;
    behavior = over * p.behavPerKg;
  } else {
    reduction = p.perX * 2;
    cost = p.costPerX * 2;
    behavior = p.behavPerX * 2;
  }

  const after = Math.max(30, (42.7 - reduction)).toFixed(1);
  document.getElementById('simAfterVal').textContent = after;
  document.getElementById('impactCO2').textContent = `-${reduction.toFixed(1)} kg`;
  document.getElementById('impactCO2Bar').style.width = Math.min(95, reduction * 8) + '%';
  document.getElementById('impactCost').textContent = cost > 0 ? `+${Math.round(cost)}ì›/ì›”` : `-${Math.round(Math.abs(cost))}ì›/ì›”`;
  document.getElementById('impactCostBar').style.width = Math.min(95, Math.abs(cost) / 100) + '%';
  document.getElementById('impactCostBar').style.background = cost > 0 ? 'var(--red)' : 'var(--green)';
  document.getElementById('impactBehavior').textContent = `ìœ¡ë¥˜ ${behavior.toFixed(1)}íšŒâ†“`;
  document.getElementById('impactBehaviorBar').style.width = Math.min(95, behavior * 15) + '%';
  const cityTotal = Math.round(reduction * 24891 * 12 / 1000);
  document.getElementById('cityImpact').textContent = `-${cityTotal}k`;

  const comments = {
    meat_tax:    `ğŸ¥© ìœ¡ë¥˜ í™˜ê²½ì„¸ ë¶€ê³¼ ì‹œ ì›” <b style="color:var(--text)">${Math.round(cost)}ì›</b> ì¶”ê°€ ë¹„ìš©. í–‰ë™ê²½ì œí•™ ëª¨ë¸ ê¸°ë°˜ ìœ¡ë¥˜ êµ¬ë§¤ <b style="color:var(--green)">${behavior.toFixed(1)}íšŒ ê°ì†Œ</b> ì˜ˆì¸¡.`,
    eco_subsidy: `ğŸŒ¿ ì¹œí™˜ê²½ ë³´ì¡°ê¸ˆ ì§€ì› ì‹œ ìƒí™œìš©í’ˆ êµì²´ë¥¼ ì´‰ì§„í•©ë‹ˆë‹¤. ì›” <b style="color:var(--green)">${Math.abs(Math.round(cost))}ì› ì ˆì•½</b>+íƒ„ì†Œ ${reduction.toFixed(1)}kg ì ˆê°.`,
    carbon_quota:`ğŸ“Š ì¿¼í„°ì œ ë„ì… ì‹œ ëª©í‘œ ì´ˆê³¼ êµ¬ê°„ì— ê²½ì œì  í˜ë„í‹°ê°€ ì‘ìš©í•©ë‹ˆë‹¤. í–‰ë™ ë³€í™” íš¨ê³¼ í¼.`,
    local_food:  `ğŸ˜ï¸ ì§€ì—­ ë†ì‚°ë¬¼ ì¸ì„¼í‹°ë¸Œ ê°•í™” ì‹œ S(ì‚¬íšŒ) ì ìˆ˜ë„ ë™ë°˜ ìƒìŠ¹í•©ë‹ˆë‹¤. ESG ì¢…í•© íš¨ê³¼!`,
  };
  document.getElementById('policyComment').innerHTML = comments[currentPolicy];
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INIT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderDashChart();
setTimeout(() => {
  const pf = document.getElementById('predFill');
  if (pf) pf.style.width = (58.2/80*100)+'%';
}, 500);
</script>
</body>
</html>
